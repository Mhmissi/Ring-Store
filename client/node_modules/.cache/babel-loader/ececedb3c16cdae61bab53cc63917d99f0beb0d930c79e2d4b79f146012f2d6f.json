{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import{ringOptions,basePrice}from\"../data/ringOptions\";import{useCart}from'../App';import{supabase}from'../lib/supabase';import ProductCard from'../components/ProductCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const getDesignLabel=value=>{const found=[...(ringOptions&&ringOptions.designs||[]),{id:'classic-solitaire',name:'Classic Solitaire'},{id:'halo-setting',name:'Halo Setting'},{id:'vintage-antique',name:'Vintage/Antique Style'},{id:'three-stone',name:'Three Stone'}].find(d=>d.id===value||d.value===value);return found?found.name:value;};const getDescription=value=>{const found=[...(ringOptions&&ringOptions.designs||[]),{id:'classic-solitaire',description:'A timeless single stone setting, perfect for any occasion.'},{id:'halo-setting',description:'Diamond surrounded by smaller stones for extra brilliance.'},{id:'vintage-antique',description:'Romantic, art-deco inspired design for a unique look.'},{id:'three-stone',description:'Past, present, and future symbolism in a trinity design.'}].find(d=>d.id===value||d.value===value);return found?found.description:'';};const allMetals=[\"white-gold\",\"yellow-gold\",\"rose-gold\",\"platinum\"];const ProductDetail=()=>{const{id}=useParams();const{addToCart}=useCart();const[product,setProduct]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchProduct=async()=>{setLoading(true);setError(null);// Fetch the product by id\nconst{data,error}=await supabase.from('ring_images').select('*').eq('id',id).single();if(error||!data){setError('Product Not Found');setProduct(null);setLoading(false);return;}// Find all images for this design/shape (for all metals)\nconst{data:allImages}=await supabase.from('ring_images').select('*').eq('design',data.design).eq('diamond_shape',data.diamond_shape);// Build images by metal\nconst images={};allMetals.forEach(metal=>{const found=(allImages||[]).find(img=>img.metal===metal);if(found){images[metal]=found.image_url?supabase.storage.from('ring-images').getPublicUrl(found.image_url).data.publicUrl:'/placeholder-ring.png';}});// Fetch pricing data for this design\nconst{data:pricingData}=await supabase.from('ring_pricing').select('*').eq('design',data.design).single();// Prepare product data for ProductCard\nsetProduct({id:data.id,design:data.design,designLabel:getDesignLabel(data.design),description:getDescription(data.design),metal:data.metal,availableMetals:allMetals.filter(metal=>images[metal]),images,price:(pricingData===null||pricingData===void 0?void 0:pricingData.price_1_0ct)||basePrice,// Default to 1.0ct price\npriceData:pricingData?{price_1_0ct:pricingData.price_1_0ct,price_1_5ct:pricingData.price_1_5ct,price_2_0ct:pricingData.price_2_0ct,price_2_5ct:pricingData.price_2_5ct}:null});setLoading(false);};fetchProduct();},[id]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:\"Loading...\"});}if(error||!product){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white min-h-screen font-sans px-4 py-12 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-black mb-4\",children:\"Product Not Found\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/shop\",className:\"text-gold font-bold hover:underline\",children:\"Back to Shop\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white min-h-screen font-sans px-4 py-12 flex items-center justify-center\",children:/*#__PURE__*/_jsx(ProductCard,{ring:product,onAddToCart:addToCart})});};export default ProductDetail;","map":{"version":3,"names":["React","useEffect","useState","useParams","ringOptions","basePrice","useCart","supabase","ProductCard","jsx","_jsx","jsxs","_jsxs","getDesignLabel","value","found","designs","id","name","find","d","getDescription","description","allMetals","ProductDetail","addToCart","product","setProduct","loading","setLoading","error","setError","fetchProduct","data","from","select","eq","single","allImages","design","diamond_shape","images","forEach","metal","img","image_url","storage","getPublicUrl","publicUrl","pricingData","designLabel","availableMetals","filter","price","price_1_0ct","priceData","price_1_5ct","price_2_0ct","price_2_5ct","className","children","href","ring","onAddToCart"],"sources":["C:/Users/test/Desktop/FinalRingsStore/client/src/pages/ProductDetail.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { ringOptions, basePrice } from \"../data/ringOptions\";\nimport { useCart } from '../App';\nimport { supabase } from '../lib/supabase';\nimport ProductCard from '../components/ProductCard';\n\nconst getDesignLabel = (value) => {\n  const found = [\n    ...((ringOptions && ringOptions.designs) || []),\n    { id: 'classic-solitaire', name: 'Classic Solitaire' },\n    { id: 'halo-setting', name: 'Halo Setting' },\n    { id: 'vintage-antique', name: 'Vintage/Antique Style' },\n    { id: 'three-stone', name: 'Three Stone' },\n  ].find(d => d.id === value || d.value === value);\n  return found ? found.name : value;\n};\nconst getDescription = (value) => {\n  const found = [\n    ...((ringOptions && ringOptions.designs) || []),\n    { id: 'classic-solitaire', description: 'A timeless single stone setting, perfect for any occasion.' },\n    { id: 'halo-setting', description: 'Diamond surrounded by smaller stones for extra brilliance.' },\n    { id: 'vintage-antique', description: 'Romantic, art-deco inspired design for a unique look.' },\n    { id: 'three-stone', description: 'Past, present, and future symbolism in a trinity design.' },\n  ].find(d => d.id === value || d.value === value);\n  return found ? found.description : '';\n};\nconst allMetals = [\"white-gold\", \"yellow-gold\", \"rose-gold\", \"platinum\"];\n\nconst ProductDetail = () => {\n  const { id } = useParams();\n  const { addToCart } = useCart();\n  const [product, setProduct] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchProduct = async () => {\n      setLoading(true);\n      setError(null);\n      // Fetch the product by id\n      const { data, error } = await supabase\n        .from('ring_images')\n        .select('*')\n        .eq('id', id)\n        .single();\n      if (error || !data) {\n        setError('Product Not Found');\n        setProduct(null);\n        setLoading(false);\n        return;\n      }\n      // Find all images for this design/shape (for all metals)\n      const { data: allImages } = await supabase\n        .from('ring_images')\n        .select('*')\n        .eq('design', data.design)\n        .eq('diamond_shape', data.diamond_shape);\n      // Build images by metal\n      const images = {};\n      allMetals.forEach(metal => {\n        const found = (allImages || []).find(img => img.metal === metal);\n        if (found) {\n          images[metal] = found.image_url ? supabase.storage.from('ring-images').getPublicUrl(found.image_url).data.publicUrl : '/placeholder-ring.png';\n        }\n      });\n      // Fetch pricing data for this design\n      const { data: pricingData } = await supabase\n        .from('ring_pricing')\n        .select('*')\n        .eq('design', data.design)\n        .single();\n      // Prepare product data for ProductCard\n      setProduct({\n        id: data.id,\n        design: data.design,\n        designLabel: getDesignLabel(data.design),\n        description: getDescription(data.design),\n        metal: data.metal,\n        availableMetals: allMetals.filter(metal => images[metal]),\n        images,\n        price: pricingData?.price_1_0ct || basePrice, // Default to 1.0ct price\n        priceData: pricingData ? {\n          price_1_0ct: pricingData.price_1_0ct,\n          price_1_5ct: pricingData.price_1_5ct,\n          price_2_0ct: pricingData.price_2_0ct,\n          price_2_5ct: pricingData.price_2_5ct\n        } : null\n      });\n      setLoading(false);\n    };\n    fetchProduct();\n  }, [id]);\n\n  if (loading) {\n    return <div className=\"text-center py-12\">Loading...</div>;\n  }\n  if (error || !product) {\n    return (\n      <div className=\"bg-white min-h-screen font-sans px-4 py-12 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-black mb-4\">Product Not Found</h1>\n          <a href=\"/shop\" className=\"text-gold font-bold hover:underline\">Back to Shop</a>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white min-h-screen font-sans px-4 py-12 flex items-center justify-center\">\n      <ProductCard ring={product} onAddToCart={addToCart} />\n    </div>\n  );\n};\n\nexport default ProductDetail; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}